<!DOCTYPE html>
<html lang="<%= lang %>" dir="<%= dir %>">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= t.errors.sessionExpired %> | <%= t.common.pharmaB2B %></title>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="stylesheet" href="/styles/admin-style.css" />
    <style>
      /* Inline styles for page-specific fun elements */
      .ghost-icon {
        font-size: 4rem;
        color: var(--text-muted);
        margin-bottom: 1.5rem;
        animation: float 3s ease-in-out infinite;
        display: inline-block;
}

      .redirect-text {
        color: var(--primary);
        font-weight: 600;
        margin-top: 2rem;
        font-size: 0.9rem;
      }

      .progress-bar {
        width: 100%;
        height: 4px;
        background: var(--surface-light);
        margin-top: 1rem;
        border-radius: 2px;
        overflow: hidden;
}

      .progress-fill {
        height: 100%;
        background: var(--primary);
        width: 100%;
        animation: shrink 5s linear forwards; /* 3 second countdown */
      }

      @keyframes float {
        0% {
          transform: translateY(0px);
}
        50% {
          transform: translateY(-15px);
}
        100% {
          transform: translateY(0px);
}
      }

      @keyframes shrink {
        from {
          width: 100%;
}
        to {
          width: 0%;
}
      }
    </style>
  </head>
  <body class="login-page">
    <div class="login-card">
      <i class="ph ph-ghost ghost-icon"></i>

      <div class="login-header" style="margin-bottom: 1rem">
        <h1><%= t.errors.accessDeniedAdmin %></h1>
        <p>
          <%= t.errors.accessDeniedMessage %>
          <br />
          <%= t.errors.sessionMessage %>
        </p>
      </div>

      <div class="redirect-text">
        <%= t.errors.escortingBack %>
        <span id="timer">5</span>...
        <br />
      </div>

      <div class="progress-bar">
        <div class="progress-fill"></div>
      </div>

      <a
        href="/admin/login"
        class="btn-primary"
        style="display: block; text-decoration: none; margin-top: 2rem"
      >
        <%= t.errors.takeMeLogin %>
      </a>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => 
{
            const toggleBtn = document.getElementById('themeToggle');
            const themeIcon = document.getElementById('themeIcon');
            const htmlEl = document.documentElement;

            // 1. Load Saved Theme
            const savedTheme = localStorage.getItem('theme') || 'dark';
            if (savedTheme === 'light') applyLight();
      
            else applyDark();

            // 2. Toggle Logic
            if(toggleBtn) {
                toggleBtn.addEventListener('click', () => {
                    const currentTheme = htmlEl.getAttribute('data-theme');
                    if (currentTheme === 'light') applyDark();
                    else applyLight();
                });
            }

            function applyLight() {
                htmlEl.setAttribute('data-theme', 'light');
                localStorage.setItem('theme', 'light');
                if(themeIcon) {
                    themeIcon.classList.replace('ph-moon', 'ph-sun');
                    themeIcon.style.color = "#f59e0b";
                }
            }

            function applyDark() {
                htmlEl.removeAttribute('data-theme');
                localStorage.setItem('theme', 'dark');
                if(themeIcon) {
                    themeIcon.classList.replace('ph-sun', 'ph-moon');
                    themeIcon.style.color = "var(--text-main)";
                }
            }
        });
</script>
    <script>
      // Simple Countdown Logic
      let count = 5;
      const timerElement = document.getElementById('timer');

      const countdown = setInterval(() => {
        count--;
        if (count > 0) {
          timerElement.innerText = count;
        } else {
          clearInterval(countdown);
          window.location.href = '/admin/login'; // The Redirect
        }
      }, 1000);
</script>
<%- include('./partials/footer') %>